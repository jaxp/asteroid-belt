FROM java:8
MAINTAINER Jax "jax94@qq.com"
ENV REFRESHED_AT 2020-11-19

EXPOSE 8070
ARG CONSUL_HOST
ARG CONSUL_TOKEN
ARG PROJECT_NAME
ENV HOME_PATH /home
WORKDIR $HOME_PATH
ADD target/$PROJECT_NAME.zip $HOME_PATH/$PROJECT_NAME.zip
RUN unzip $PROJECT_NAME.zip
RUN echo $CONSUL_HOST
RUN echo $CONSUL_TOKEN
RUN echo $PROJECT_NAME

WORKDIR $HOME_PATH/$PROJECT_NAME
VOLUME ["$HOME_PATH/$PROJECT_NAME"]
ENTRYPOINT ./bin/start.sh token $CONSUL_HOST $CONSUL_TOKEN